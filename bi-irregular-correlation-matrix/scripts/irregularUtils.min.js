/* 
irregularUtils.js

Created by Ralf Becher - ralf.becher@web.de - (c) 2016 irregular.bi, Leipzig, Germany
Tested on Qlik Sense 2.2.3

irregular.bi takes no responsibility for any code.
Use at your own risk. */
function isEditMode(t){return t.inEditState()||"state/edit"==window.location.pathname.substring(window.location.pathname.length-10)}function flattenPages(t){var e=[];return $.each(t,function(){$.each(this.qMatrix,function(){e.push(this)})}),e}function pageExtensionData(t,e,n,a,o,i){i=i||2;var r=0,c=n.qHyperCube.qSize.qcx;console.log(n.qHyperCube.qSize.qcy);var d=Math.floor(1e4/c);if(t.backendApi.eachDataRow(function(t,e){r=t}),t.backendApi.getRowCount()>r+1&&n.qHyperCube.qDataPages.length<i){var h=[{qTop:r+1,qLeft:0,qWidth:c,qHeight:Math.min(d,t.backendApi.getRowCount()-r)}];console.log(h),t.backendApi.getData(h).then(function(r){console.log(r),pageExtensionData(t,e,n,a,o,i)})}else{var l=[];l=flattenPages(n.qHyperCube.qDataPages),a(e,n,l,t,o)}}function toLocalFixedUnPadded(t,e){return t.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:e})}function toLocalFixed(t,e){return t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e})}function dataToString(t){if(t.length>0){for(var e="data:text/csv;charset=utf-8,",n=t[0].length,a=t.length,o=encodeURIComponent(";"),i=encodeURIComponent("\r\n"),r=0;n>r;r++)e+=encodeURIComponent(t[0][r]),e+=n-1>r?o:i;for(var a,c=1;a>c;c++)for(var r=0;n>r;r++)e+=encodeURIComponent(t[c][r]),e+=n-1>r?o:i;console.log(e)}return e}function arrayToTable(t,e,n,a){var o,i,r,c=$("<table />").attr({"class":e}).css({width:n}),d=[];for(i=0;i<t.length;i+=1){for(o=$("<tr />"),r=0;r<t[i].length;r+=1)0===i?o.append($("<th />").css("text-align",a[r]).html(t[i][r])):o.append($("<td />").attr("align",a[r]).html(t[i][r]));d.push(o)}for(thead=d.shift(),thead=$("<thead />").append(thead),c.append(thead),i=0;i<d.length;i+=1)c.append(d[i]);return c}